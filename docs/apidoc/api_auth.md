# Документация API

----
[Описание системы](../index.md) ➞ [Документация API](index.md) ➞ Аутентификация в API

----

## Схема доступа

Для доступа к большинству методов данного API требуется аутентифицировать себя. Аутентификация производится посредством предоставления серверу API в запросе своего токена доступа (JWT-токена). При истечении срока токена доступа требуется предоставить обновляющий токен для получения нового токена доступа либо предоставить логин и пароль для генерации токенов.

Для использования системы предварительно требуется произвести регистрацию, послав соответствующий GET-запрос.

Таким образом, **схема получения доступа** к методам API представляет собой следующую последовательность действий:
1. Регистрация.
2. Получение токена доступа и обновляющего токена (JWT-Token and Refresh Token) после предоставления пары логина и пароля.
3. Передача JWT-токена при осуществлении запросов.
4. Предоставление Refresh-токена по истечению срока действия токена доступа и получение новой пары JWT- и Refresh-токенов.
5. Возврат к пункту 2 в следующих случаях:
	* истечение срока действия Refresh-токена;
	* утеря Refresh-токена.

-----

## Методы API регистрации и аутентификации

*Графа "ответ" в таблицах ниже не упоминает возврат кода состояния HTTP.*
<br/><br/>

### Регистрация

**Доступ:** не требует аутентификации.

|	Адрес метода				|	Тип запроса			|	Параметры			| Ответ
|	:----:						|	:----:				|	:----:				| :----:
| **/api/accounts/register**	|	POST				| login<br />password	| —

**Значения параметров:**
* `login` : логин пользователя;
* `password` : пароль пользователя.

Для регистрации требуется указать логин и пароль нового пользователя при осуществлении запроса. Логин должен быть уникальным для системы.
<br/><br/>

### Получение токенов доступа

**Доступ:** требуется аутентификация.

|	Адрес метода				|	Тип запроса			|	Параметры			| Ответ
|	:----:						|	:----:				|	:----:				| :----:
| **/api/accounts/gettoken**	|	GET					| —						| JSON:<br />access_token<br />refresh_token

Метод возвращает JSON со значениями JWT-токена доступа (`access_token`) и обновляющего Refresh-токена (`refresh_token`).
<br/><br/>

### Обновление токена доступа

**Доступ:** требуется аутентификация.

|	Адрес метода					|	Тип запроса			|	Параметры			| Ответ
|	:----:							|	:----:				|	:----:				| :----:
| **/api/accounts/refreshtoken**	|	POST				| refreshToken			| JSON:<br />access_token<br />refresh_token

**Значения параметров:**
* `refreshToken` : значение Refresh-токена.

Метод возвращает новую пару JWT-токена доступа (`access_token`) и обновляющего Refresh-токена (`refresh_token`) при предоставлении ему корректного действующего обновляющего токена.
<br/><br/>

### Изменение пароля

**Доступ:** требуется аутентификация.

|	Адрес метода					|	Тип запроса			|	Параметры			| Ответ
|	:----:							|	:----:				|	:----:				| :----:
| **/api/accounts/changepassword**	|	POST				| password				| JSON:<br/>refresh_token

**Значения параметров:**
* `password` : новый пароль пользователя.

Если пользователь, осуществляющий запрос, успешно аутентифицирован в системе по своему JWT-токену, метод изменяет пароль пользователя и возвращает новый Refresh-токен.
<br/><br/>
